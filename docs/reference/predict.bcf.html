<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Takes a fitted bcf object produced by bcf() and produces predictions for a new set of covariate values — predict.bcf • bcf</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Takes a fitted bcf object produced by bcf() and produces predictions for a new set of covariate values — predict.bcf" />
<meta property="og:description" content="This function takes in an existing BCF model fit and uses it to predict estimates for new data.
It is important to note that this function requires that you indicate where the trees from the model fit are saved.
You can do so using the save_tree_directory argument in bcf(). Otherwise, they will be saved in the working directory.
The bcf() function automatically saves those in the same directory as the" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bcf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/E01_simple-example.html">A Simple Example</a>
    </li>
    <li>
      <a href="../articles/E02_predict-example.html">Prediction using BCF</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Takes a fitted bcf object produced by bcf() and produces predictions for a new set of covariate values</h1>
    
    <div class="hidden name"><code>predict.bcf.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes in an existing BCF model fit and uses it to predict estimates for new data.
It is important to note that this function requires that you indicate where the trees from the model fit are saved.
You can do so using the save_tree_directory argument in bcf(). Otherwise, they will be saved in the working directory.
The bcf() function automatically saves those in the same directory as the</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for bcf</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(
  <span class='no'>object</span>,
  <span class='no'>x_predict_control</span>,
  <span class='no'>x_predict_moderate</span>,
  <span class='no'>pi_pred</span>,
  <span class='no'>z_pred</span>,
  <span class='no'>save_tree_directory</span>,
  <span class='kw'>n_cores</span> <span class='kw'>=</span> <span class='fl'>2</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>output from a BCF predict run</p></td>
    </tr>
    <tr>
      <th>x_predict_control</th>
      <td><p>matrix of covariates for the "prognostic" function mu(x) for predictions (optional)</p></td>
    </tr>
    <tr>
      <th>x_predict_moderate</th>
      <td><p>matrix of covariates for the covariate-dependent treatment effects tau(x) for predictions (optional)</p></td>
    </tr>
    <tr>
      <th>pi_pred</th>
      <td><p>propensity score for prediction</p></td>
    </tr>
    <tr>
      <th>z_pred</th>
      <td><p>Treatment variable for predictions (optional except if x_pre is not empty)</p></td>
    </tr>
    <tr>
      <th>save_tree_directory</th>
      <td><p>directory where the trees have been saved</p></td>
    </tr>
    <tr>
      <th>n_cores</th>
      <td><p>An optional integer of the number of cores to run your MCMC chains on</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments affecting the predictions produced.</p></td>
    </tr>
    </table>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>

<span class='co'># data generating process</span>
<span class='no'>p</span> <span class='kw'>=</span> <span class='fl'>3</span> <span class='co'>#two control variables and one moderator</span>
<span class='no'>n</span> <span class='kw'>=</span> <span class='fl'>250</span>

<span class='no'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>*<span class='no'>p</span>), <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>n</span>)

<span class='co'># create targeted selection</span>
<span class='no'>q</span> <span class='kw'>=</span> -<span class='fl'>1</span>*(<span class='no'>x</span>[,<span class='fl'>1</span>]<span class='kw'>&gt;</span>(<span class='no'>x</span>[,<span class='fl'>2</span>])) + <span class='fl'>1</span>*(<span class='no'>x</span>[,<span class='fl'>1</span>]<span class='kw'>&lt;</span>(<span class='no'>x</span>[,<span class='fl'>2</span>]))

<span class='co'># generate treatment variable</span>
<span class='no'>pi</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>pnorm</a></span>(<span class='no'>q</span>)
<span class='no'>z</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='no'>n</span>,<span class='fl'>1</span>,<span class='no'>pi</span>)

<span class='co'># tau is the true (homogeneous) treatment effect</span>
<span class='no'>tau</span> <span class='kw'>=</span> (<span class='fl'>0.5</span>*(<span class='no'>x</span>[,<span class='fl'>3</span>] <span class='kw'>&gt;</span> -<span class='fl'>3</span>/<span class='fl'>4</span>) + <span class='fl'>0.25</span>*(<span class='no'>x</span>[,<span class='fl'>3</span>] <span class='kw'>&gt;</span> <span class='fl'>0</span>) + <span class='fl'>0.25</span>*(<span class='no'>x</span>[,<span class='fl'>3</span>]<span class='kw'>&gt;</span><span class='fl'>3</span>/<span class='fl'>4</span>))

<span class='co'># generate the response using q, tau and z</span>
<span class='no'>mu</span> <span class='kw'>=</span> (<span class='no'>q</span> + <span class='no'>tau</span>*<span class='no'>z</span>)

<span class='co'># set the noise level relative to the expected mean function of Y</span>
<span class='no'>sigma</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='no'>q</span> + <span class='no'>tau</span>*<span class='no'>pi</span>))/<span class='fl'>8</span>

<span class='co'># draw the response variable with additive error</span>
<span class='no'>y</span> <span class='kw'>=</span> <span class='no'>mu</span> + <span class='no'>sigma</span>*<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>)

<span class='co'># If you didn't know pi, you would estimate it here</span>
<span class='no'>pihat</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>pnorm</a></span>(<span class='no'>q</span>)

<span class='no'>bcf_fit</span> <span class='kw'>=</span> <span class='fu'><a href='bcf.html'>bcf</a></span>(<span class='kw'>y</span>               <span class='kw'>=</span> <span class='no'>y</span>,
              <span class='kw'>z</span>               <span class='kw'>=</span> <span class='no'>z</span>,
              <span class='kw'>x_control</span>       <span class='kw'>=</span> <span class='no'>x</span>,
              <span class='kw'>x_moderate</span>      <span class='kw'>=</span> <span class='no'>x</span>,
              <span class='kw'>pihat</span>           <span class='kw'>=</span> <span class='no'>pihat</span>,
              <span class='kw'>nburn</span>           <span class='kw'>=</span> <span class='no'>n_burn</span>,
              <span class='kw'>nsim</span>            <span class='kw'>=</span> <span class='no'>n_sim</span>,
              <span class='kw'>n_chains</span>        <span class='kw'>=</span> <span class='fl'>2</span>,
              <span class='kw'>update_interval</span> <span class='kw'>=</span> <span class='fl'>1</span>,
              <span class='kw'>save_tree_directory</span> <span class='kw'>=</span> <span class='st'>'./trees'</span>)</div><div class='output co'>#&gt; <span class='error'>Error in bcf(y = y, z = z, x_control = x, x_moderate = x, pihat = pihat,     nburn = n_burn, nsim = n_sim, n_chains = 2, update_interval = 1,     save_tree_directory = "./trees"): object 'n_burn' not found</span></div><div class='input'>
<span class='co'># Predict using new data</span>

<span class='no'>x_pred</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>*<span class='no'>p</span>), <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>n</span>)

<span class='no'>pred_out</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='kw'>bcf_out</span><span class='kw'>=</span><span class='no'>bcf_fit</span>,
                   <span class='kw'>x_predict_control</span><span class='kw'>=</span><span class='no'>x_pred</span>,
                   <span class='kw'>x_predict_moderate</span><span class='kw'>=</span><span class='no'>x_pred</span>,
                   <span class='kw'>pi_pred</span><span class='kw'>=</span><span class='no'>pihat</span>,
                   <span class='kw'>z_pred</span><span class='kw'>=</span><span class='no'>z</span>,
                   <span class='kw'>save_tree_directory</span> <span class='kw'>=</span> <span class='st'>'./trees'</span>)</div><div class='output co'>#&gt; <span class='error'>Error in predict(bcf_out = bcf_fit, x_predict_control = x_pred, x_predict_moderate = x_pred,     pi_pred = pihat, z_pred = z, save_tree_directory = "./trees"): object 'bcf_fit' not found</span></div><div class='input'>
# }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jared S. Murray, P. Richard Hahn, Carlos Carvalho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


